
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tracks layer tutorial &#8212; napari tutorials</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vectors layer tutorial" href="vectors.html" />
    <link rel="prev" title="surface layer tutorial" href="surface.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.ico" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">napari tutorials</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   napari tutorials
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../gallery.html">
   napari gallery
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="README.html">
   Fundamentals
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="installation.html">
     napari installation tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="getting_started.html">
     getting started with napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="viewer.html">
     napari viewer tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="image.html">
     image layer tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="labels.html">
     labels layer tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="points.html">
     points layer tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="shapes.html">
     shapes layer tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="surface.html">
     surface layer tutorial
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     tracks layer tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors.html">
     vectors layer tutorial
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../applications/README.html">
   Applications
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/annotate_segmentation.html">
     annotating segmentation with text and bounding boxes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/annotate_points.html">
     annotating videos with napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/dask.html">
     using dask and napari to process &amp; view large datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/napari_imageJ.html">
     Napari + ImageJ How-to-Guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/cell_tracking.html">
     single cell tracking with napari
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/fundamentals/tracks.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-example">
   a simple example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arguments-of-view-tracks-and-add-tracks">
   arguments of view_tracks and add_tracks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tracks-data">
   tracks data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tracks-graph">
   tracks graph
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-tracks-properties-dictionary">
   using the tracks properties dictionary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-rendering-of-tracks">
   3D rendering of tracks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#changing-track-width">
   changing track width
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#changing-tail-length">
   changing tail length
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-the-track-color-with-properties">
   setting the track color with properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#layer-visibility">
   layer visibility
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#layer-opacity">
   layer opacity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#blending-layers">
   blending layers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#naming-layers">
   naming layers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scaling-layers">
   scaling layers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#translating-layers">
   translating layers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#layer-metadata">
   layer metadata
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#putting-it-all-together">
   putting it all together
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-steps">
   next steps
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="tracks-layer-tutorial">
<h1>tracks layer tutorial<a class="headerlink" href="#tracks-layer-tutorial" title="Permalink to this headline">¶</a></h1>
<p>Welcome to the tutorial on the <strong>napari</strong> <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer! Please note that <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer is a new layer type that will be released in <code class="docutils literal notranslate"><span class="pre">napari</span> <span class="pre">0.4.0</span></code>, but it is available for preview on the <a class="reference external" href="https://github.com/napari/napari">master branch</a>.</p>
<p>This tutorial assumes you have already installed <strong>napari</strong>,
know how to launch the viewer,
and are familiar with its layout.
For help with installation see our <a class="reference internal" href="installation.html"><span class="doc std std-doc">installation</span></a> tutorial.
For help getting started with the viewer see our <a class="reference internal" href="getting_started.html"><span class="doc std std-doc">getting started</span></a> tutorial.
For help understanding the organisation of the viewer,
including things like the layers list,
the layer properties widgets,
the layer control panels,
and the dimension sliders
see our <a class="reference internal" href="viewer.html"><span class="doc std std-doc">napari viewer</span></a> tutorial.</p>
<p>This tutorial will teach you about the <strong>napari</strong> <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer,
including displaying tracks and defining relationships between tracks.</p>
<p>The tracks layer allows you to display trajectories in nD + t while visualizing the recent history of the track via a fading tail.</p>
<p>Each track can have annotations associated with it using the <code class="docutils literal notranslate"><span class="pre">Tracks.properties</span></code> dictionary.
These properties can be used to set the colors of the tracks.</p>
<p>For example, when displaying tracks of different classes/types,
one could automatically set color the individual tracks by their respective class/type.</p>
<div class="section" id="a-simple-example">
<h2>a simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h2>
<p>You can create a new viewer and add a set of tracks in one go using the <code class="docutils literal notranslate"><span class="pre">napari.view_tracks</span></code> method,
or if you already have an existing viewer,
you can add tracks to it using <code class="docutils literal notranslate"><span class="pre">viewer.add_tracks</span></code>.
The api of both methods is the same.</p>
<p>In this example of we will overlay some tracks on an image from the Hubble space telescope:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">hubble_image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hubble_deep_field</span><span class="p">()</span>

<span class="n">tracks_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="p">]</span>

<span class="k">with</span> <span class="n">napari</span><span class="o">.</span><span class="n">gui_qt</span><span class="p">():</span>
    <span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">view_image</span><span class="p">(</span><span class="n">test_im</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">)</span>
    <span class="n">viewer</span><span class="o">.</span><span class="n">add_tracks</span><span class="p">(</span><span class="n">tracks_data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tracks&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p><img alt="image: tracks simple demo" src="../_images/tracks_simple_demo.gif" /></p>
</div>
<div class="section" id="arguments-of-view-tracks-and-add-tracks">
<h2>arguments of view_tracks and add_tracks<a class="headerlink" href="#arguments-of-view-tracks-and-add-tracks" title="Permalink to this headline">¶</a></h2>
<p>Both <code class="docutils literal notranslate"><span class="pre">view_tracks</span></code> and <code class="docutils literal notranslate"><span class="pre">add_tracks</span></code> have the following doc strings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">data : array (N, D+1)</span>
<span class="sd">    Coordinates for N points in D+1 dimensions. ID,T,(Z),Y,X. The first</span>
<span class="sd">    axis is the integer ID of the track. D is either 3 or 4 for planar</span>
<span class="sd">    or volumetric timeseries respectively.</span>
<span class="sd">properties : dict {str: array (N,)}, DataFrame</span>
<span class="sd">    Properties for each point. Each property should be an array of length N,</span>
<span class="sd">    where N is the number of points.</span>
<span class="sd">graph : dict {int: list}</span>
<span class="sd">    Graph representing associations between tracks. Dictionary defines the</span>
<span class="sd">    mapping between a track ID and the parents of the track. This can be</span>
<span class="sd">    one (the track has one parent, and the parent has &gt;=1 child) in the</span>
<span class="sd">    case of track splitting, or more than one (the track has multiple</span>
<span class="sd">    parents, but only one child) in the case of track merging.</span>
<span class="sd">    See examples/tracks_3d_with_graph.py</span>
<span class="sd">color_by: str</span>
<span class="sd">    Track property (from property keys) by which to color vertices.</span>
<span class="sd">tail_width : float</span>
<span class="sd">    Width of the track tails in pixels.</span>
<span class="sd">tail_length : float</span>
<span class="sd">    Length of the track tails in units of time.</span>
<span class="sd">colormap : str</span>
<span class="sd">    Default colormap to use to set vertex colors. Specialized colormaps,</span>
<span class="sd">    relating to specified properties can be passed to the layer via</span>
<span class="sd">    colormaps_dict.</span>
<span class="sd">colormaps_dict : dict {str: napari.utils.Colormap}</span>
<span class="sd">    Optional dictionary mapping each property to a colormap for that</span>
<span class="sd">    property. This allows each property to be assigned a specific colormap,</span>
<span class="sd">    rather than having a global colormap for everything.</span>
<span class="sd">name : str</span>
<span class="sd">    Name of the layer.</span>
<span class="sd">metadata : dict</span>
<span class="sd">    Layer metadata.</span>
<span class="sd">scale : tuple of float</span>
<span class="sd">    Scale factors for the layer.</span>
<span class="sd">translate : tuple of float</span>
<span class="sd">    Translation values for the layer.</span>
<span class="sd">opacity : float</span>
<span class="sd">    Opacity of the layer visual, between 0.0 and 1.0.</span>
<span class="sd">blending : str</span>
<span class="sd">    One of a list of preset blending modes that determines how RGB and</span>
<span class="sd">    alpha values of the layer visual get mixed. Allowed values are</span>
<span class="sd">    {&#39;opaque&#39;, &#39;translucent&#39;, and &#39;additive&#39;}.</span>
<span class="sd">visible : bool</span>
<span class="sd">    Whether the layer visual is currently being displayed.</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">layer : napari.layers.Tracks</span>
<span class="sd">    The newly-created tracks layer.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="tracks-data">
<h2>tracks data<a class="headerlink" href="#tracks-data" title="Permalink to this headline">¶</a></h2>
<p>The input data to the tracks layer must be an NxD+1 numpy array or list containing the coordinates of N vertices with a track ID and coordinate in D dimensions. The ordering of these dimensions is the same as the ordering of the dimensions for image layers.
This array is always accessible through the <code class="docutils literal notranslate"><span class="pre">layer.data</span></code> property
and will grow or shrink as new tracks are either added or deleted.</p>
<p>Consider the set of 4D tracks data (time + 3 spatial dimensions) defined below. The <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer assumes the first column is the <code class="docutils literal notranslate"><span class="pre">track_id</span></code>, the second column is the time axis, and columns 3-5 are Z, Y, and X, respectively. Each row is one vertex in a track. All vertices with the same <code class="docutils literal notranslate"><span class="pre">track_id</span></code> are joined into a single track. In this case, we have defined 2 tracks: track 0, which goes from [10, 10, 10] to [20, 10, 10] and track 1, which goes from [10, 8, 5] to [7, 8, 10] (coordinates written as [x, y z]).</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>track_id</p></th>
<th class="head"><p>t</p></th>
<th class="head"><p>z</p></th>
<th class="head"><p>y</p></th>
<th class="head"><p>x</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>10</p></td>
<td><p>10</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>10</p></td>
<td><p>10</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
<td><p>8</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
<td><p>7</p></td>
</tr>
</tbody>
</table>
<p>The data in the array must be sorted by increasing <code class="docutils literal notranslate"><span class="pre">track_id</span></code> then time, as shown above.  We can pass the example data above to the tracks layer as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">tracks_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="p">]</span>

<span class="k">with</span> <span class="n">napari</span><span class="o">.</span><span class="n">gui_qt</span><span class="p">():</span>
    <span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">view_tracks</span><span class="p">(</span><span class="n">tracks_data</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="section" id="tracks-graph">
<h2>tracks graph<a class="headerlink" href="#tracks-graph" title="Permalink to this headline">¶</a></h2>
<p>We can use the tracks <code class="docutils literal notranslate"><span class="pre">graph</span></code> argument to define the relationships between tracks (e.g., tracks merging or tracks splitting). The graph is defined as a dictionary where the keys are the <code class="docutils literal notranslate"><span class="pre">track_id</span></code> and the values are the <code class="docutils literal notranslate"><span class="pre">track_id</span></code> of the parents of the the key.</p>
<p>For example, if we have a track 0, which splits into tracks 1 and 2 (i.e., track 0 is the parent of tracks 1 and 2), we would define the graph as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If later tracks 1 and 2 merge into track 3 (i.e,. tracks 1 and 2 are the parent of track 3), the dictionary would become</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For a full example of 3d+t tracks data with a parent graph, please see our <a class="reference external" href="https://github.com/napari/napari/blob/master/examples/tracks_3d_with_graph.py"><code class="docutils literal notranslate"><span class="pre">tracks_3d_with_graph.py</span></code> example</a>.</p>
</div>
<div class="section" id="using-the-tracks-properties-dictionary">
<h2>using the tracks properties dictionary<a class="headerlink" href="#using-the-tracks-properties-dictionary" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer can contain properties that annotate the vertices of each track.
<code class="docutils literal notranslate"><span class="pre">Tracks.properties</span></code> stores the properties in a dictionary
where each key is the name of the property
and the values are numpy arrays with a value for each vertex in the track (i.e., length N for N vertices in <code class="docutils literal notranslate"><span class="pre">Tracks.data</span></code>).
As we will see below, we can use the values in a property to set the display properties of the tracks (e.g., the track color).</p>
</div>
<div class="section" id="d-rendering-of-tracks">
<h2>3D rendering of tracks<a class="headerlink" href="#d-rendering-of-tracks" title="Permalink to this headline">¶</a></h2>
<p>All our layers can be rendered in both 2D and 3D mode,
and one of our viewer buttons can toggle between each mode.
The number of dimensions sliders will be 2 or 3 less than the total number of dimensions of the layer.</p>
</div>
<div class="section" id="changing-track-width">
<h2>changing track width<a class="headerlink" href="#changing-track-width" title="Permalink to this headline">¶</a></h2>
<p>We can specify the width of the tracks in pixels. The track width can be specified via the <code class="docutils literal notranslate"><span class="pre">tail_width</span></code> keyword argument in the <code class="docutils literal notranslate"><span class="pre">viewer.add_tracks()</span></code> and <code class="docutils literal notranslate"><span class="pre">napari.view_tracks()</span></code> methods. From a layer that as already been constructed, we can set the track width via the <code class="docutils literal notranslate"><span class="pre">layer.tail_width</span></code> property.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a tracks layer with a tail width of 5 pixels</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">view_tracks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tail_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_tracks&quot;</span><span class="p">)</span>

<span class="c1"># update the tail width to 3 pixels</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s2">&quot;my_tracks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">=</span> <span class="mi">3</span>

</pre></div>
</div>
<p>Additionally, we can adjust the width of the track in the GUI using the “tail width” slider in the Tracks layer controls.</p>
<p><img alt="image: tracks tail width" src="../_images/tracks_tail_width.gif" /></p>
</div>
<div class="section" id="changing-tail-length">
<h2>changing tail length<a class="headerlink" href="#changing-tail-length" title="Permalink to this headline">¶</a></h2>
<p>We can specify the length of the tails of the tracks in time units. The tail is the portion of the track displayed from previous time steps. The track tail length can be specified via the <code class="docutils literal notranslate"><span class="pre">tail_length</span> </code> keyword argument in the <code class="docutils literal notranslate"><span class="pre">viewer.add_tracks()</span></code> and <code class="docutils literal notranslate"><span class="pre">napari.view_tracks()</span></code> methods. From a layer that as already been constructed, we can set the track width via the <code class="docutils literal notranslate"><span class="pre">tail_length</span> </code> property.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a tracks layer with a tail length of 5 time units</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">view_tracks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tail_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_tracks&quot;</span><span class="p">)</span>

<span class="c1"># update the tail width to 3 pixels</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s2">&quot;my_tracks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail_length</span> <span class="o">=</span> <span class="mi">3</span>

</pre></div>
</div>
<p>Additionally, we can adjust the width of the track in the GUI using the “tail length” slider in the Tracks layer controls.</p>
<p><img alt="image: tracks tail length" src="../_images/tracks_tail_length.gif" /></p>
</div>
<div class="section" id="setting-the-track-color-with-properties">
<h2>setting the track color with properties<a class="headerlink" href="#setting-the-track-color-with-properties" title="Permalink to this headline">¶</a></h2>
<p>We can color the tracks by mapping colors to the track properties defined in <code class="docutils literal notranslate"><span class="pre">Tracks.properties</span></code>. If we define properties and pass them via the properties keyword argument in the <code class="docutils literal notranslate"><span class="pre">viewer.add_tracks()</span></code> and <code class="docutils literal notranslate"><span class="pre">napari.view_tracks()</span></code> methods, we can then select the property we would like to color the tracks by in the “color by” dropdown menu in the <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer controls. We can additionally specify the colormap used to map the property value to color via the “colormap” dropdown menu.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">hubble_image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hubble_deep_field</span><span class="p">()</span>

<span class="n">tracks_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">636</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">track_confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="p">[</span><span class="mf">0.9</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">[</span><span class="mf">0.3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">tracks_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">track_confidence</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">napari</span><span class="o">.</span><span class="n">gui_qt</span><span class="p">():</span>
    <span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">view_image</span><span class="p">(</span><span class="n">hubble_image</span><span class="p">)</span>
    <span class="n">viewer</span><span class="o">.</span><span class="n">add_tracks</span><span class="p">(</span><span class="n">tracks_data</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image: tracks colored by properties" src="../_images/tracks_color_by.gif" /></p>
</div>
<div class="section" id="layer-visibility">
<h2>layer visibility<a class="headerlink" href="#layer-visibility" title="Permalink to this headline">¶</a></h2>
<p>All our layers support a visibility toggle that allows you to set the <code class="docutils literal notranslate"><span class="pre">visible</span></code> property of each layer.
This property is located inside the layer widget in the layers list and is represented by an eye icon.</p>
</div>
<div class="section" id="layer-opacity">
<h2>layer opacity<a class="headerlink" href="#layer-opacity" title="Permalink to this headline">¶</a></h2>
<p>All our layers support an opacity slider and <code class="docutils literal notranslate"><span class="pre">opacity</span></code> property
that allow you to adjust the layer opacity between 0, fully invisible, and 1, fully visible.
The opacity value applies globally to all the tracks in the layer.</p>
</div>
<div class="section" id="blending-layers">
<h2>blending layers<a class="headerlink" href="#blending-layers" title="Permalink to this headline">¶</a></h2>
<p>All our layers support three blending modes <code class="docutils literal notranslate"><span class="pre">translucent</span></code>, <code class="docutils literal notranslate"><span class="pre">additive</span></code>, and <code class="docutils literal notranslate"><span class="pre">opaque</span></code>
that determine how the visuals for this layer get mixed with the visuals from the other layers.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">opaque</span></code> layer renders all the other layers below it invisible
and will fade to black as you decrease its opacity.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">translucent</span></code> setting will cause the layer to blend with the layers below it if you decrease its opacity
but will fully block those layers if its opacity is 1.
This is a reasonable default, useful for many applications.</p>
<p>The final blending mode <code class="docutils literal notranslate"><span class="pre">additive</span></code> will cause the layer to blend with the layers below even when it has full opacity.
This mode is especially useful for visualizing multiple layers at the same time.</p>
</div>
<div class="section" id="naming-layers">
<h2>naming layers<a class="headerlink" href="#naming-layers" title="Permalink to this headline">¶</a></h2>
<p>All our layers support a <code class="docutils literal notranslate"><span class="pre">name</span></code> property that can be set inside a text box inside the layer widget in the layers list.
The name of each layer is forced into being unique
so that you can use the name to index into <code class="docutils literal notranslate"><span class="pre">viewer.layers</span></code> to retrieve the layer object.</p>
</div>
<div class="section" id="scaling-layers">
<h2>scaling layers<a class="headerlink" href="#scaling-layers" title="Permalink to this headline">¶</a></h2>
<p>All our layers support a <code class="docutils literal notranslate"><span class="pre">scale</span></code> property and keyword argument
that will rescale the layer multiplicatively according to the scale values (one for each dimension).
This property can be particularly useful for viewing anisotropic data
where the size of the voxel in the z dimension might be different then the size in the x and y dimensions.</p>
</div>
<div class="section" id="translating-layers">
<h2>translating layers<a class="headerlink" href="#translating-layers" title="Permalink to this headline">¶</a></h2>
<p>All our layers support a <code class="docutils literal notranslate"><span class="pre">translate</span></code> property and keyword argument
that you can use to offset a layer relative to the other layers,
which could be useful if you are trying to overlay two layers for image registration purposes.</p>
</div>
<div class="section" id="layer-metadata">
<h2>layer metadata<a class="headerlink" href="#layer-metadata" title="Permalink to this headline">¶</a></h2>
<p>All our layers also support a <code class="docutils literal notranslate"><span class="pre">metadata</span></code> property and keyword argument
that you can use to store an arbitrary metadata dictionary on the layer.</p>
</div>
<div class="section" id="putting-it-all-together">
<h2>putting it all together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this headline">¶</a></h2>
<p>Here you can see an example of 3D+t tracks. You can view the source code for this example <a class="reference external" href="https://github.com/napari/napari/blob/master/examples/tracks_3d.py">here</a></p>
<p><img alt="image: tracks 3D plus time" src="../_images/tracks_3d_t.gif" /></p>
</div>
<div class="section" id="next-steps">
<h2>next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>Hopefully, this tutorial has given you a detailed understanding of the <code class="docutils literal notranslate"><span class="pre">Tracks</span></code> layer,
including how to create one and control its properties.
To learn more about some of the other layer types that <strong>napari</strong> supports
checkout some more of our tutorials listed below.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./fundamentals"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="surface.html" title="previous page">surface layer tutorial</a>
    <a class='right-next' id="next-link" href="vectors.html" title="next page">vectors layer tutorial</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>